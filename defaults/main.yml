---

# Can be tarball or package
netdata_installation_type: tarball
netdata_release: 1.17.1

# https://github.com/netdata/netdata/blob/master/packaging/installer/kickstart-static64.sh
netdata_tarball_checksum: "sha256:509e674a99f943ee3d3ddb7a0ce055635360fe46c81a5ca6ac8ea663464b422a"
netdata_tarball_release: "v{{ netdata_release }}"
# yamllint disable-line rule:line-length
netdata_tarball_url: "https://github.com/netdata/netdata/releases/download/{{ netdata_tarball_release }}/netdata-{{ netdata_tarball_release }}.gz.run"

# yamllint disable-line rule:line-length
netdata_package_repo_file_url: "https://packagecloud.io/install/repositories/netdata/netdata/config_file.repo?os={{ ansible_distribution | lower }}&dist={{ ansible_distribution_major_version }}"
netdata_package_repo_file_path: /etc/yum.repos.d/netdata_netdata.repo

_netdata:
  tarball:
    stock_config_dir: /opt/netdata/usr/lib/netdata/conf.d
    user_config_dir: /opt/netdata/etc/netdata
    env_PATH: "/opt/netdata/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin"
    packages: &packages
      - iproute
      - nmap-ncat
      - lm_sensors
      - python
      - python-dns
      - python-ipaddress
  package:
    stock_config_dir: /usr/lib64/netdata/conf.d
    user_config_dir: /etc/netdata
    env_PATH: "/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin"
    packages:
      - *packages
      - "netdata-{{ netdata_release }}"

# Can be: /usr/lib64/netdata/conf.d or /opt/netdata/usr/lib/netdata/conf.d
netdata_stock_config_dir: "{{ _netdata[netdata_installation_type]['stock_config_dir'] }}"

# Can be: /etc/netdata or /opt/netdata/etc/netdata
netdata_user_config_dir: "{{ _netdata[netdata_installation_type]['user_config_dir'] }}"

#
# https://www.kernel.org/doc/Documentation/vm/ksm.txt
# https://github.com/netdata/netdata/tree/master/database#ksm
#
# Boolean can be: true or false
netdata_ksm_enabled: true
netdata_ksm_sys_path: /sys/kernel/mm/ksm
netdata_ksm_config:
  run: 1
  sleep_millisecs: 1000
  pages_to_scan: 100

netdata_required_packages_extra: []
netdata_required_packages:
  - epel-release

netdata_packages_extra: []
netdata_packages: "{{ _netdata[netdata_installation_type]['packages'] }}"

#
# Anonymous statistics disabled by default
# https://docs.netdata.cloud/docs/anonymous-statistics/
#
netdata_telemetry: false

netdata_config_netdata_conf:
  type: ini  # Can be ini or yml
  path: netdata.conf  # Relative path
  data:
    registry:
      enabled: false
      registry to announce: http://localhost:19999
      memory mode: save
      memory deduplication (ksm): "{{ netdata_ksm_enabled | bool }}"
    global:
      update every: 5
    web:
      bind to: 127.0.0.1
    plugins:
      PATH environment variable: "{{ _netdata[netdata_installation_type]['env_PATH'] }}"
      # List of plugins enabled & configured https://docs.netdata.cloud/collectors/
      node.d: false
    plugin:proc:
      # Disable IPVS check since we doesn't use ipvs by default
      /proc/net/ip_vs/stats: no

netdata_config_fping_conf:
  type: ini
  path: fping.conf  # Relative path
  data:
    null:
      hosts: 1.1.1.1
  no_extra_spaces: true

netdata_config_go_d_conf:
  type: yml
  path: go.d.conf  # Relative path
  data:
    modules:
      example: false
      web_log: true  # Also see python.d plugin

netdata_config_python_d_conf:
  type: yml
  path: python.d.conf  # Relative path
  data:
    enabled: true  # Enable / disable the whole python.d.plugin (all its modules)
    default_run: true  # default for all modules is disabled (no), default: true
    adaptec_raid: true
    apache: false  # See go.d plugin instead
    apache_cache: false  # by default
    beanstalk: true
    bind_rndc: true
    boinc: true
    ceph: true
    chrony: true
    couchdb: true
    dns_query_time: false  # See go.d plugin instead
    dnsdist: true
    dockerd: true
    dovecot: true
    elasticsearch: true
    energid: true
    example: false  # by default
    exim: true
    fail2ban: true
    freeradius: false  # See go.d plugin instead
    go_expvar: false  # by default
    gunicorn_log: false  # by default
    haproxy: true
    hddtemp: true
    httpcheck: false  # See go.d plugin instead
    icecast: true
    ipfs: true
    isc_dhcpd: true
    litespeed: true
    logind: false  # by default
    megacli: true
    memcached: true
    mongodb: true
    monit: true
    mysql: false  # See go.d plugin instead
    nginx: false  # See go.d plugin instead
    nginx_log: false  # by default
    nginx_plus: false  # See go.d plugin instead
    nsd: true
    ntpd: true
    nvidia_smi: true
    openldap: true
    oracledb: true
    ovpn_status_log: true
    phpfpm: true
    portcheck: false  # See go.d plugin instead
    postfix: true
    postgres: true
    powerdns: true
    proxysql: true
    puppet: true
    rabbitmq: false  # See go.d plugin instead
    redis: true
    rethinkdbs: true
    retroshare: true
    samba: true
    sensors: true
    smartd_log: true
    spigotmc: true
    springboot: true
    squid: true
    tomcat: true
    tor: true
    traefik: true
    unbound: true  # by default: false
    uwsgi: true
    varnish: true
    w1sensor: true
    web_log: false  # See go.d plugin instead

netdata_config_python_d_chrony_conf:
  type: yml
  path: python.d/chrony.conf  # Relative path
  data:
    local:
      command: 'timeout -k 5 3 chronyc -n tracking'
